<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>修改密码</title>
<link rel="stylesheet" href="jqm/jquery.mobile-1.3.2.min.css" />
		<link rel="stylesheet" type="text/css" href="http://dev.jtsage.com/cdn/simpledialog/latest/jquery.mobile.simpledialog.min.css" /> 
		
		<link rel="stylesheet" href="css/mm7.css" />
		<script src="js/jquery-1.10.2.min.js"></script>
		<script src="jqm/jquery.mobile-1.3.2.min.js"></script>
		<script type="text/javascript" src="http://dev.jtsage.com/cdn/simpledialog/latest/jquery.mobile.simpledialog2.min.js"></script>
		<script src="js/mm7.js"></script>pt>

</head>
<body>
	<div data-role="page" id="modify_password" data-theme="b">
	<script type="text/javascript">
$('#modify_password').bind('pagecreate', function(){
	// 如果当前浏览器不支持，则停止执行
	if(!browserSupport()){
		alert('请使用以下浏览器进行浏览（Chrome20+,FireFox10+,IE9+,360浏览器6.0+）');
	}else{
		
		//判断是否登录
		if(isLogin()){
			initEvent_ModifyPassword();
		}else{
			$.mobile.changePage('login.html');
			
		}
		
	}
});
/**
 * 初始化事件
 */
function initEvent_ModifyPassword(){
	$('.logout_button').on('tap', function(event){
		logout();
	});
	$('#modifypassword_button').on('tap', function(event){
		modifyValidation();
	});
}
/**
 * 验证修改
 */
function modifyValidation(){
	// 显示loading动画
	$.mobile.loading( 'show', {
		  text: '正在加载...',
		  textVisible: true,
		  theme: 'a',
		  textonly: false,
		  html: ''
	});
	var oldpassword = $('#oldpassword').val();
	var newpassword = $('#newpassword').val();
	var confirmpassword = $('#confirmpassword').val();
	
	if(oldpassword == undefined || oldpassword.length < 4){
		$.mobile.loading('hide');
		alert('旧密码不能为空，并且长度不能少于4个字符.');
		return;
	}
	if(newpassword == undefined || newpassword.length < 4){
		$.mobile.loading('hide');
		alert('新密码不能为空，并且长度不能少于4个字符.');
		return;
	}
	if(confirmpassword == undefined || confirmpassword.length < 4){
		$.mobile.loading('hide');
		alert('确认密码不能为空，并且长度不能少于4个字符.');
		return;
	}
	
	if(newpassword != confirmpassword){
		$.mobile.loading('hide');
		alert('新密码和确认密码必须一致');
		return;
	}
	
	alert('修改密码成功！请重新登录！');
	logout();
	$.mobile.changePage('login.html');
	
}
</script>
		<div data-role="header">
			<h1>修改密码</h1>
			<a data-role="button" class="logout_button" data-icon="back" href="login.html"
				data-iconpos="left" class="ui-btn-left">退出 </a>
		</div>


		<div data-role="content">

			<div class="content_menu">

				<ul data-role="listview" data-theme="c" data-dividertheme="d">
					<li><a href="index.html">首页</a></li>
					<li><a href="createsendtask.html">创建发送任务</a></li>
					<li><a href="showsendtask.html">查看发送任务</a></li>
					<li><a href="showfaillist.html">查看失败号码</a></li>
					<li data-theme="b"><a href="modifypassword.html">修改密码</a></li>
				</ul>
			</div>


			<div class="content_main">

				<form action="">
		            <div data-role="fieldcontain">
		                <label for="oldpassword">
		                    原密码
		                </label>
		                <input name="" id="oldpassword" placeholder="" value="" type="password">
		            </div>
		            <div data-role="fieldcontain">
		                <label for="newpassword">
		                    新密码
		                </label>
		                <input name="" id="newpassword" placeholder="" value="" type="password">
		            </div>
		            <div data-role="fieldcontain">
		                <label for="confirmpassword">
		                    确认新密码
		                </label>
		                <input name="" id="confirmpassword" placeholder="" value="" type="password">
		            </div>
		            <a data-role="button" id="modifypassword_button">修改密码</a>
		        </form>


			</div>



		</div>

		<div data-role="footer" data-theme="c">
			<p style="text-align: center">By Panshihao.Cn</p>
		</div>


	</div>
</body>
</html>