<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>登录</title>
<link rel="stylesheet" href="jqm/jquery.mobile-1.3.2.min.css" />
<link rel="stylesheet" type="text/css" href="http://dev.jtsage.com/cdn/simpledialog/latest/jquery.mobile.simpledialog.min.css" /> 

<link rel="stylesheet" href="css/mm7.css" />
<script src="js/jquery-1.10.2.min.js"></script>
<script src="jqm/jquery.mobile-1.3.2.min.js"></script>
<script type="text/javascript" src="http://dev.jtsage.com/cdn/simpledialog/latest/jquery.mobile.simpledialog2.min.js"></script>
<script src="js/ajax.js"></script>
<script src="js/mm7.js"></script>
</head>
<body>
<div data-role="page" id="login" data-theme="b">
	<script type="text/javascript">
	$('#login').bind('pagecreate', function(){
		if(!browserSupport()){
			alert('请使用以下浏览器进行浏览（Chrome20+,FireFox10+,IE9+,360浏览器6.0+）');
		}else{
			//判断是否登录
			if(isLogin()){
				$.mobile.changePage('index.html'); 
			}else{
				initEvent_Login();
			}
			
		}
	}); 
	/**
	 * 初始化事件
	 */
	function initEvent_Login(){
		$('#login_button').bind('tap', function(event){
			loginValidation();
		});
		$('#login input').keydown(function(event){
			if(event.keyCode == 13){
				loginValidation();
			}
		});
	}
	/**
	 * 登录验证
	 */
	function loginValidation(){
		// 显示loading动画
		$.mobile.loading( 'show', {
			  text: '正在加载...',
			  textVisible: true,
			  theme: 'a',
			  textonly: false,
			  html: ''
		});
		
		var username = $('#login_username').val();
		var password = $('#login_password').val();
		
		if(username == undefined || username.length < 4){
			$.mobile.loading('hide');
			alert('用户名不能为空，并且长度不能少于4个字符.');
			return;
		}else if(password == undefined || password.length < 4){
			$.mobile.loading('hide');
			alert('密码不能为空，并且长度不能少于4个字符.');
			return;
		}
		
		// 模拟登录
		if(username == 'admin' && password == 'admin'){
			$.mobile.loading('hide');
			// 登录成功后调用
			var user = new Object();
			user.username = 'admin';
			user.grade = 3;
			
			loginSuccess(user);
		}else{
			$.mobile.loading('hide');
			alert('用户名或密码错误');
			return;
		}
		
		
		
		
	}
	/**
	 * 登录成功
	 * @param user
	 */
	function loginSuccess(user){
		
		localStorage.setItem('User', user);
		$.mobile.changePage('index.html'); 
		
	}
	</script>
	
	
	
		<div data-role="header">
			<h1>登　录</h1>
		</div>

		<div data-role="content">
			<form action="">
				<div data-role="fieldcontain">
					<label for="login_username">用户名</label> <input name=""
						id="login_username" placeholder="" value="" type="text">
				</div>
				<div data-role="fieldcontain">
					<label for="login_password">密码</label> <input name=""
						id="login_password" placeholder="" value="" type="password">
				</div>
				<a data-role="button" id="login_button">登录 </a>
			</form>
		</div>
		<div data-role="footer" data-theme="c">
			<p style="text-align: center">By Panshihao.Cn</p>
		</div>
	</div>
</body>
</html>